% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gen_responses_all.R
\name{gen_responses_all}
\alias{gen_responses_all}
\title{Generate Synthetic Survey Responses from Existing Data}
\usage{
gen_responses_all(
  respondents,
  question,
  model = "GPT-4.1",
  embedding_model = "titan-embed-text-v2:0",
  base_url = "https://litellmproxy.osu-ai.org",
  k_similar = 10,
  api_key = Sys.getenv("OPENAI_API_KEY")
)
}
\arguments{
\item{respondents}{A dataframe containing the survey respondents.}

\item{question}{The prompt or question to simulate responses for.}

\item{model}{The model to use for the chat (defaults to "gpt-4.1")}

\item{embedding_model}{The embedding model to use for generating vector representations (defaults to "titan-embed-text-v2:0")}

\item{base_url}{The base URL to the endpoint. Default is "https://litellmproxy.osu-ai.org".}

\item{k_similar}{Number of most similar respondents to use as reference when generating. Default is 10.}

\item{api_key}{API key for the embedding and chat service. Default reads from \code{Sys.getenv("OPENAI_API_KEY")}.}
}
\value{
A data frame containing the input profiles along with a new column 'response' containing simulated responses to the question.
}
\description{
This function generates realistic synthetic responses for survey data by leveraging text embeddings (Titan embeddings)
or a TF-IDF (Term Frequency – Inverse Document Frequency) fallback if embeddings fail.
It selects a set of respondents most similar to each target respondent and prompts a language model to produce a realistic answer to a survey question.
No new profiles are created. The function generates answers based on the characteristics of the input data.
}
\details{
The function does the following:
\enumerate{
\item Builds a text corpus from character columns in \code{respondents}.
\item Computes numeric representations of text. It attempts embeddings first, then falls back to TF-IDF vectors if embeddings fail.
\item Standardizes numeric columns and combines with text embeddings.
\item Computes cosine similarity between each respondent and all others.
\item Selects the top \code{k_similar} most similar respondents for each target respondent. The target respondent’s own profile is always counted in the set of similar profiles, so the model sees their data plus the \code{k_similar}- 1 most similar other profiles.
\item Prompts the LLM to generate a realistic, short answer based on the similar profiles.
\item Cleans and stores the generated response in the \code{response} column.
}
}
\examples{
respondents <- data.frame(
  age = c(23, 45, 38, 52, 33, 33, 51),
  gender = c("F", "M", "M", "F", "M", "M", "M"),
  department = c("HR", "IT", "IT", "Marketing", "Advertising", "Finance", "HR"),
  years_in_company = c(3, 4, 1, 5, 2, 8, 5),
  remote = c("No", "Yes", "Yes", "Yes", "No", "No", "Yes"),
  satisfaction =c("High", "Medium", "High", "Low", "Medium", "High", "Low"),
  stringsAsFactors = FALSE)

synthetic_responses <- gen_responses_all(
  respondents,
  question = "Do you feel supported at your job?",
  k_similar = 3)

}
